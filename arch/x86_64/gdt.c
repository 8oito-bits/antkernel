#include "gdt.h"

extern void gdtr_set(u64);

struct gdt_entry gdt[] =
{
  GDT_ENTRY(0x0, 0x0, 0x0, 0x0, 0x0),
  GDT_ENTRY(0x0, 0x0, 0xa, 0x0, 0x17),
  GDT_ENTRY(0x0, 0x0, 0x2, 0x0, 0x1b),
  GDT_ENTRY(0x0, 0x0, 0xa, 0x3, 0x17),
  GDT_ENTRY(0x0, 0x0, 0x2, 0x3, 0x1b)
};


struct gdt_register gdtr;

void gdt_load(void)
{
  gdtr.limit = sizeof(gdt) - 1;
  gdtr.base = (u64) &gdt;

  gdtr_set((u64) &gdtr);
}
